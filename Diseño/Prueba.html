<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Programa Oportunidades ‚Äî Interactivo</title>

  <!-- Font Awesome (√≠conos) -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root{
      --red:#b71c1c;
      --red-strong:#c62828;
      --muted:#f5f0ee;
      --dark:#222;
      --card:#fff;
      --accent:#e53935;
      --grid:#e6eef6; /* tono azul suave para cuadricula */
      --notebook-grid-1: rgba(0,0,0,0.03);
      --notebook-grid-2: rgba(0,0,0,0.04);
      --highlight: #f6c85f;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:var(--muted);
      color:var(--dark);
      -webkit-font-smoothing:antialiased;
    }

    header{
      text-align:center;
      padding:28px 16px;
      background:linear-gradient(90deg,#7f0000,#b71c1c);
      color:white;
    }
    header h1{ margin:0; font-size:28px; letter-spacing:.4px; }
    header p{ margin:6px 0 0; opacity:.95; max-width:900px; margin-left:auto;margin-right:auto;}

    main.container{
      display:grid;
      grid-template-columns: 1fr 360px;
      gap:20px;
      max-width:1200px;
      margin:28px auto;
      padding:0 16px 60px;
      align-items:start;
    }

    /* MAP AREA */
    .map-panel{
      background:#8b1b1b;
      color:white;
      border-radius:16px;
      padding:18px;
      position:relative;
      min-height:480px;
      box-shadow:0 8px 30px rgba(0,0,0,.12);
      overflow:hidden;
    }

    /* Map container (we'll use an SVG) */
    .map-wrap{
      display:block;
      width:100%;
      height:420px;
      position:relative;
    }

    /* Simple caption CTA inside map */
    .cta-box{
      position:absolute;
      left:22px;
      bottom:22px;
      background:rgba(0,0,0,.45);
      color:#fff;
      padding:12px 18px;
      border-radius:12px;
      display:flex;
      align-items:center;
      gap:12px;
      max-width:340px;
      cursor:pointer;
    }
    .cta-box .hand{ font-size:22px; opacity:.95 }
    .cta-box:hover{ transform:translateY(-3px); transition:transform .18s ease;}

    /* Right column (global stats) */
    .stats-panel{
      background:var(--card);
      border-radius:16px;
      padding:18px;
      box-shadow:0 8px 30px rgba(0,0,0,.06);
    }

    .stat-card{
      display:flex;
      gap:14px;
      align-items:center;
      padding:14px;
      border-radius:10px;
      margin-bottom:12px;
      background:linear-gradient(90deg,#fff,#fff);
    }
    .stat-card .icon{
      width:54px;height:54px;border-radius:12px;
      background:var(--accent); color:white; display:flex;
      align-items:center; justify-content:center; font-size:20px;
    }
    .stat-card .num{ font-size:22px; font-weight:700; color:var(--red-strong) }
    .stat-card .text{ font-size:13px; opacity:.9 }

    /* === OVERLAY: ahora el contenido puede desplazarse === */
    #seccion-departamento{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.35);
      display:none;
      z-index:1200;
      padding:22px;
      overflow-y:auto; /* Permite ver todo lo largo */
      justify-content:center;
      align-items:flex-start; /* <--- Cambio CLAVE */
    }

    /* === CARD DETALLE: se expande seg√∫n contenido === */
    .detalle{
      width:min(1200px,97%);
      background:#fff;
      border-radius:14px;
      display:grid;
      grid-template-columns: 400px 1fr;
      gap:0;
      box-shadow:0 20px 50px rgba(0,0,0,.32);
      position:relative;
      height:auto; /* <--- Importante */
      margin-top:30px; /* Bajar para que no choque arriba */
    }

    /* Panel Izquierdo */
    .detalle .left{
      background:#f3f3f3;
      padding:20px;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:14px;
    }

    /* Imagen Silueta */
    .silhouette{
      width:90%;
      height:260px;
      background-size:cover;
      background-position:center;
      border-radius:8px;
      box-shadow: inset 0 0 0 6px rgba(199,0,0,.05);
    }

    /* Panel Derecho */
    .detalle .right{
      padding:20px;
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    /* === √ÅREA DE GR√ÅFICO, estilo cuaderno matem√°tico === */
    .chart-area{
      background:#fff;
      border-radius:10px;
      padding:18px;
      border:1px solid #ddd;
      margin-top:8px;

      background-image:
        linear-gradient(to right, rgba(0,0,0,0.04) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(0,0,0,0.04) 1px, transparent 1px);
      background-size: 26px 26px;
    }

    /* Canvas ESTABLE: se ve COMPLETO */
    .chart-area canvas{
      width:100% !important;
      min-height:430px !important;
      display:block;
    }

    /* Note under chart */
    .chart-note{
      margin-top:8px;
      font-size:13px;
      color:#333;
      background:#fff8f8;
      border-left:4px solid var(--red-strong);
      padding:10px;
      border-radius:6px;
    }

    /* Visual badge for slope */
    .slope-badge{
      display:inline-flex;
      gap:8px;
      align-items:center;
      padding:8px 10px;
      border-radius:10px;
      background:linear-gradient(90deg,#fff,#fff);
      border:1px solid #eee;
      box-shadow: 0 4px 10px rgba(0,0,0,0.04);
      font-weight:700;
    }
    .slope-badge .icon{ font-size:18px; color:var(--red-strong) }

    /* Highlight styles */
    .positive-slope { color: #0a7c1b; font-weight:700; } /* green */
    .negative-slope { color: #0a4fa7; font-weight:700; } /* blue-ish for desercion reduction */

    /* Close button */
    .close-detail{
      position:absolute; right:12px; top:12px;
      background:#fff; border-radius:10px; padding:8px 10px; cursor:pointer; border:1px solid #ddd;
    }

    /* Map SVG styles */
    svg.map-svg{ 
      width:100%; 
      height:100%; 
      display:block; 
      background: #8b1b1b;
      border-radius: 8px;
    }
    
    /* Estilo base para todos los departamentos */
    .departamento {
      fill: #a83232;
      stroke: #ffffff;
      stroke-width: 0.5;
      transition: fill 0.3s;
    }
    
    /* Estilo para departamentos interactivos */
    .departamento.interactivo {
      cursor: pointer;
      fill: #c44;
    }
    
    /* Efecto hover para departamentos interactivos */
    .departamento.interactivo:hover {
      fill: #e55;
    }
    
    /* Estilo para departamento seleccionado */
    .departamento.seleccionado {
      fill: #ff6b6b;
      stroke-width: 2;
      filter: drop-shadow(0 0 8px rgba(255,255,255,0.5));
    }

    /* RESPONSIVE */
    @media(max-width:960px){
      .detalle{
        grid-template-columns:1fr;
      }
      .silhouette{
        height:200px;
      }
      .chart-area canvas{
        min-height:350px !important;
      }
    }

    /* responsive */
    @media (max-width:960px){
      main.container{ grid-template-columns: 1fr; }
      .detalle{ grid-template-columns: 1fr; height:80vh; }
      .silhouette{ height:200px; width:60%;}
      .chart-area canvas { height: 280px !important; }
    }
.filtro {
  background:#e2e8f0;
  border:none;
  padding:10px 14px;
  border-radius:10px;
  cursor:pointer;
  font-size:14px;
  transition:background .25s ease, transform .25s ease;
}
.filtro:hover {
  background:#cbd5e1;
  transform:scale(1.05);
}
.filtro.activo {
  background:#2563eb;
  color:white;
}
  </style>
</head>
<body>

  <header>
    <h1>Programa Oportunidades</h1>
    <p>Empoderando a j√≥venes salvadore√±os mediante herramientas educativas y oportunidades de formaci√≥n y empleo.</p>
  </header>

  <main class="container">
    <!-- Izquierda: mapa -->
    <section class="map-panel" aria-label="Mapa de El Salvador">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <strong style="font-size:18px">Explora nuestras sedes</strong>
        <small style="opacity:.85">Haz clic en un departamento</small>
      </div>

      <div class="map-wrap" id="mapWrap">
        <!-- Mapa SVG real de El Salvador -->
        <svg class="map-svg" viewBox="0 0 1000 547" preserveAspectRatio="xMidYMid meet" role="img" aria-label="Mapa interactivo de El Salvador">
          <!-- Departamentos no interactivos -->
          <path class="departamento" d="M183.1 180l3.2 1.3 6.8 4.3 1.3 1.2 0.7 0.8 0.4 0.8 0.8 3.2 0.4 0.9 0.6 0.9 1.3 1.3 1.6 1.2 1.3 1.4 0.1 0.1 0.8 1.5 0.3 0.9-1.1 6.9-7.5 25.9-6.7 2.8-8.2 2.3-4.6 0.7-1 0.7-0.8 1.1-0.4 2.5-0.1 1.6 0.9 7.2 0.6 2.3 0.7 1.7 0.9 1.8 0.3 0.9-0.2 1.3-7.6 11.7-0.7 2.1-0.2 1.6 3.1 10 0.4 2.2-0.5 1.5-1.1 1.8-2.8 3.4-1.1 2.1-0.6 1.6-0.3 3.6-0.3 1-4.8 8.6-0.7 1.9-2.1 8.6-1.9 0.8-3.1 0.4-11.3-0.7-2.3-0.5-0.8-0.5-2.7-2.6-4.9-5.7-0.8-0.6-1.5-1.1-0.9-0.4-1-0.4-1.4-0.1-1.5 0-2.1 0.4-1.3 0.4-1.1 0.5-0.9 0.6-1.1 0.9-2.8 3.4-5.9 9.4-0.9 1.4-25.4-11.6-29-14-6-25.1-0.1-6 0.9-6.3 2-6.1 3-5.6 4.5-4.6 10.3-5.5 4.6-3.8 3.4-5.4 2.5-5.6 3.2-5.5 5.6-4.9 36.1-25.3 7.9-8 4-2.7 16.7-6.3 5.5-0.4 6.8 1.8 9.8 7.6 5.5 2.3 5.5-3 0.1-2.2-0.3-0.6z" id="SVAH" name="Ahuachap√°n"></path>
          <path class="departamento" d="M324.5 181.7l-4.4 1.2-5.6 0-5.6-1.1-4.2-3.8-1.1-8.4 7.2-24.8 7.1 0.5 0.9-0.4 0.9-0.5 0.7-0.7 0.9-1.2 4.4-8.1 0.7-0.6 0.8-0.5 0.9-0.4 1-0.3 1-0.2 3.8-0.2 1.2-0.2 1-0.3 1-0.3 0.8-0.5 0.8-0.6 1.3-1.3 7.3-10.1 0.7-1.8 0.1-1.5-0.3-4.3 0-7.7 14-5.7 3.3-3.7 1.5-7.8 4.8-14-6.9-4.4-1.8-2.4-0.8-0.7-5.6-2.9-1.3-1.1-0.8-0.8-1.7-2.9-1.2-2.9-0.5-0.7-2.5-2.8-14.3-13.4 14.5 2.3 11.6 5.6 19.2 4.1 9.5 6.7 17.3 5.2 3.6-3.2 5.4-10.5 3-3.1 3.3-0.9 2.2 0.4 1.9 1.7 2.1 3 1.9 3.5 0.8 3.9-0.3 3.9-1.5 3.8 4.3 3.7 12.8 1.5 6 3 2.4 4.8 1.5 11.9 1.7 3.5 9.5 7.2 3.4 4.2 3.4 5.7 1.4 4.9 0.2 1.8 0.4 3.2 1.2 4.1 3.3 2.4 3.7-0.8 4.4-2.6 5.3-2.3 5.8 0.1 9.3 6 7.9 9.9 5.6 11.6 2.5 10.9 6.6-1 16.4 1.3 4.5-1.8 3.9-2.4 3.3-0.3 2.7 4.4-0.4 6.5-2.2 6.4-0.2 5.5 5.9 3.8 8 1.1 1.8 0.6 2.7 2.4 1.8 2.6 0.9 3.2-0.2 2-17.3 2.6-7.7 3.8-2.9 3.8-2.5 2-4.5 2.1-23.1 7.6-5.6 2.1-5.2 1.3-9.8-0.9-11.1 0.3-6.2-0.7-5.8-2.2-6.8 0.5-8-3.8-1.4-0.9-1.7-1.6-2-2.9-1-2.1-0.6-1.8-0.3-1-0.1-0.9 0-1.1 0.3-1.6 0-0.1-0.2-0.7-0.7-1-8.2-9.8-1.7-3-0.6-0.8-6.3-4.5-2.7-2.4-1.9-1.1-9.7-3.5-4.7-2.4-1.3-0.1-1.2 0-6.6 3.4-10.4 4.8-4.2-1-5.3-4.2-2.4 4.8-5.2-0.1-7.8-3.4-2.9 1-4.9 3.5-1.5 0.8-2.7-0.4-3.6-1.7-1.2-0.3-6.1-0.9-6.8-3.9-3.9-0.8-3.6 2.8-3.5 1.9-4.4 0.9-3.1 1.2-1.2 2.6-1.7 2.7z" id="SVCH" name="Chalatenango"></path>
          <path class="departamento" d="M490.3 217.5l11.1-0.3 9.8 0.9 5.2-1.3 5.6-2.1 23.1-7.6 4.5-2.1 2.5-2 2.9-3.8 7.7-3.8 17.3-2.6 0 0.7 2.3-0.9 9.5-1.5 9.6 0.7 28.4 9.1 16.6 1.2 3.6 1.6 3.4 3.3-0.3 1.2-0.1 0.9-0.2 0.2-0.4 0.3-0.1 0-1.5-0.2 0.4 0.9 1.9 4.2-0.2 4.5-1.3 4.7-0.8 5.7 1 3.7 4.1 10.2 0.3 6.1-3.3 5.5-0.7 0.6-1.7 1.5 2.4 4.8-0.6 4.6-2.6 3.9-4.1 2.6 0.8 5.3-3.5 5.4-3.4 6.7 0 0.1-6.1 4.1-3.5-0.9-9.5-1.2-1.4-0.5-0.7-0.6-0.5-0.8-0.3-1-0.4-2.1-0.6-0.9-1-0.5-2.6-0.7-0.9-0.4-2.6-1.5-3.9-1.4-0.9-0.5-6.9-5.1-0.9-0.4-4.1-0.8-5.2-0.3-2.4-0.4-12 0.1-2.7-0.2-1.8-0.5-5.4-3.9-1.2 0.1-1.4 0.7-1.9 2.5-1.2 1.3-1.3 0.8-2.2-0.2-2.7-0.6-2.5 0.6-11.7 5.2-3.6 1.2-2.6 0.4-3.9-1.3-2.2-0.5-2.4-0.1-1 1.4-0.7 1.2-0.5 11.1-13-3.6-3.4-1.9-0.4-1-2.4-3.7-3.6-3.9-1.5-2-0.9-1.7-0.5-2.5-0.5-1.5-1.9-3.4-0.4-1.6-0.3-1.7-1.4-3-1.8-2.1-3.1-2.1-2.3-2.4-7.3-10.4-1.8-3.3-0.9-2.5 0.2-1.2 0.3-1 0.3-0.9 0.6-0.9 0.6-0.6 0.8-0.6 5-2.9 1.4-1.2 1.3-1.4 1.1-1.6 0.4-0.9 5.5-8.8z" id="SVCA" name="Caba√±as"></path>
          <path class="departamento" d="M736.4 228.6l1.5-2.6 2.5-2.8 4.5-1.9 3.3 0.5 2.4-0.5 1.8-5.3-0.6-1-3.4-3.1-0.8-1.4-0.3-7.7 0.1-1.3 3.7-1.4 5.7 0.6 0.9 0.2 9 2 6 0.2 19.6-2.4 9.9 0.6 4.3 3.6 5.5 14.3 5.4 6.6 7 6.3 6.1 7.4 3.1 9.5 17.1-8.5 5.6-1.5 0.9 0.1 1.2 7.6 1.6 6.3 0.7 10.9-1.5 23.5 0.1 1.3 0.2 1 0.5 0.8 1.7 2.2 0.5 0.9 0.4 0.9 0.3 0.9 0.4 2.4-0.2 7.4-1.1 8.9-2.2 10.4-8.6 22.3-0.7 7.3-2.7 4.2-11.6 12.4-8.1-1.3-3.9 0.2-14.7 4.6-2.8 0.3-1.8-0.3-0.6-0.6-0.6-1.1-0.3-0.8-0.9-1-1.3-1.2-5.5-3.3-0.8-0.6-0.6-0.8-0.4-0.8-1.1-6.9-0.6-2.1-1.4-2.6-1.6-2.1-1.3-0.8-1.4-0.5-14.6 1.2-2.1 0.4-1.9 0.8-3 1.8-2.1 0.6-0.6-0.5-0.1-0.6 0.5-0.9 2.2-3 0.4-0.9 0.1-1-0.6-1-0.9-0.9-2.7-1.7-0.8-0.7-0.6-0.7-0.3-0.9-0.3-1.1-0.2-1.1-0.8-1.5-1.4-1.9-3.5-2.6-1.4-1.4-0.7-2.3-1.2-1.9-4.8-4.3-1.9-2.3-1.2-1.8-0.6-9.7 0-1 0.4-0.8 0.7-0.7 12.3-8.9 1.7-1 2.9-1 0.9-0.5 0.7-0.7 0.6-0.7 0.3-1.1 0-1.4-0.7-2.3-1-1.5-0.8-1-14.2-9.7-2.1-1.9-1.4-1.5-0.3-1-0.3-1-0.1-3.8 0.3-2.1 0.2-0.7 0.2-0.7 0.5-0.8 1.1-1.4 0.7-0.6 0.8-0.5 0.6-0.7 0.6-0.8 0.4-0.8 0.4-1 0.2-1.1 0-2.3-1.2-3.2-1.5-2.9-0.6-1.7-0.1-1.3-0.7-3.1-4.4-10.4-2.1-2.9z" id="SVMO" name="Moraz√°n"></path>
          <path class="departamento" d="M836.2 370.7l11.6-12.4 2.7-4.2 0.7-7.3 8.6-22.3 2.2-10.4 1.1-8.9 0.2-7.4-0.4-2.4-0.3-0.9-0.4-0.9-0.5-0.9-1.7-2.2-0.5-0.8-0.2-1-0.1-1.3 1.5-23.5-0.7-10.9-1.6-6.3-1.2-7.6 2.1 0.5 5.5 3.6 2.6 0.7 1.7-0.8 4.8-3.8 3-1 3.7 0.2 7.4 1.6 3.6-0.3 3.6-2.6 3.1-3.9 3.8-3.2 5.6-0.2 3.6 2.8 3.6 10.2 3.1 4.6 1.9 1.1 5.3 2.1 2.3 1.2 5.9 5.2 10.6 9.1 6.6 2.7-3.3 5.6-7.6 17.6-1.9 6.3 2.4 6.4-1.8 4.1-3.8 3.6-3.3 4.7-1.3 6.9 0.3 14.3-0.9 7-9 21.9-2.2 10.6 4 8.8 3.8 1.4 8-2.6 5.4 2.1 2.9 3.4 2 4.6 0.6 5.2-0.9 4.9-6.4 7.4-29.6 13.6-0.3-0.1-2.9-1.8-1.9-3.1-2.8-8.3-10.6 18.4-2.7 10.8 6.9 4.8 4.4 1.7 12.4 12 7.1 4.8 0.6 2.2 0 4.7-3 8.2-7.5 5.9-27.9 14.1-7.6 6.1-1.3 6.1 8.7 6-13.3 3.1-51.7-3.6-9.6-1.8 0-0.1 2.1-30.2 0.5-2.9 1-3.8 0.8 0.3 3.1 2.3 3.2 1.9 3.9 1.4 1.3 0.3 1.2 0 1.8-0.5 0.8-0.9 4.9-16.1 0.3-2.4-0.6-2.2-0.1-1.6 4.8-27.8-0.1-0.9-0.4-1-0.4-0.9-3.5-5.6-0.5-0.9-0.3-1-1.1-6.8-0.2-9.9 0.3-2.5 0.6-1.5 0.7-0.6 1.6-0.9 1-0.8 1.1-0.9 1.4-1.7 0.4-1.3 0-1.2-1.5-5.6-0.2-11.7 0.8-4.9 2.5-3.3z m105.9 136.3l-0.3-4.9 2.7-2 5.2 1.7 3.2 7.1 0.2 5.9 1.4 3.9-3.1 1.8-4.9-1.8-3.2 1.5 0-4.2-2-4.1 0.8-4.9z m-14.8-19.2l2.9 1.8 2.5 5.6-2.2 3.2-2.5 2.4-4.9-4.4-1.2-6.1 2.2-2.2 3.2-0.3z" id="SVUN" name="La Uni√≥n"></path>
          <path class="departamento" d="M292.5 284.3l1.8-10.7 6.6-18 0.7-8.3-0.4-6.9 0.5-10.4 0.5-2.1 0.6-0.8 0.8-0.5 0.9-0.3 1 0.1 0.9 0.3 1.1-0.1 1.2-0.8 3-4.9 0.8-0.4 1-0.1 1.3 0 1.4 0 1.9-0.9 0.8-1 0.4-1.2 0.6-7.5-0.1-1.2 0.7-5.5 4-21.4 1.7-2.7 1.2-2.6 3.1-1.2 4.4-0.9 3.5-1.9 3.6-2.8 3.9 0.8 6.8 3.9 6.1 0.9 1.2 0.3 3.6 1.7-0.4 13-2 8.3-0.1 2.1 0.2 1.4 2.3 1.8 0.9 1.3 1.1 2 1.9 4.4 1.1 2.1 1 1.4 1.6 1 1.8 0.9 3 0.9 1.1 0.1 3.5-0.3 1.2 0 1.1 0.2 1.1 0.2 1 0.4 1.2 0.7 1.4 1.1 2 1.1 0.6 0.8 0.1 0.6-1 2.6-0.5 2.2-0.1 0.4-0.3 0.3-2.8-0.1-1 0.3-0.7 0.7-0.4 1.2-1.9 21.6-0.5 2.2-0.4 0.9-0.8 0.5-1.9 0.7-0.9 0.5-0.7 0.6-1.2 1.4-0.7 1.9-0.5 1.8-0.7 6.8-0.8 3-1.2 2.8-0.7 3.6-0.4 6.2-0.3 1.6-0.3 1-2.6 4.9-1.7 4.8 0.2 1.5 0.6 0.8 1 0.3 1.2 0.1 1.9 2.5-0.4 3.8 0.3 3.7 0.4 1 0.5 0.8 0.6 0.7 1.5 1.1 0.7 0.9 0.4 1.3 0.7 3 0.6 1.7 0.7 1.1 0.8 0.6 5.4 2.9 0.7 0.5 1.6 1.4 2.5 3.4 0.4 1.4-0.2 1.2-1.2 2.3-0.9 2.2 0.1 1.2 0.8 0.8 2.9 1.4 0.4 0.9-0.2 0.9-0.6 0.7-0.7 0.6-0.6 2.2-0.2 3.7 0.7 15.9-0.2 1.2-2.4 6.1-0.8 3.4-0.1 1.8 0.2 1.4 6 9.8 2.1 4.6 0.6 0.7 0.8 0.4 1.1 0.2 1.2-0.1 2.1-0.5 3.9-1.3 2.2-0.3 1.4 0.2 1 0.3 2.8 1.2 1.3 6.3 1.1 1.6 0.9 0 1.6 0.1 2 0.5 3.7 1.5 1.3 1.3 0.3 1.1-1 1.7-1.8 2.2-0.5 0.8-0.6 0.7-2.9 5.2-1 2.3-1.2 3.6-17.9-11-25.5-11.3-27.6-6.6-12.8 0-9.8-2.3-53.3 0.5-22.8-5.8-8.1-1.5 1-2.5 4-9.1 2-3.2 9.5-8.4 1.6-1.9 1.1-1.5 0.5-4.7 0.7-3.2 0.8-1.9 0.9-1.2 0.8-0.8 0.7-0.5 8.2-8.2 1.9-2.6 1-1.8 0.1-1.3-0.5-8.5 0.6-4.5 1.1-4.6 0.8-2.1 0.8-1.4 0.8-0.7 1.5-0.9 0.9-0.2 2.6-0.3 1.5-0.6 1.5-1.2 4.4-5.5 2.1-1.9 5.5-3.2 2.4-1.7 2.7-2.4 1-1.5 0.5-1.5-0.2-1-0.3-1-0.5-0.8-0.7-0.6-0.8-0.6-0.9-0.4-4.3-1.4z" id="SVLI" name="La Libertad"></path>
          <path class="departamento" d="M413 423.6l1.2-3.6 1-2.3 2.9-5.2 0.6-0.7 0.5-0.8 1.8-2.2 1-1.7-0.3-1.1-1.3-1.3-3.7-1.5-2-0.5-1.6-0.1-0.9 0-1.1-1.6-1.3-6.3 0.8-3.2 1.1-0.7 2.7-3 1.9-4.1 3.2-9.6 0.8-4.2 0.2-2.7-0.7-1.9-2.9-5.1-1.1-3.1-0.7-3.3 0.2-1.8 0.5-1.2 0.9-0.5 1-0.2 1.2 0 1.1 0.2 6 1.9 1.2 0.2 1.1 0.1 1.9-1.5 11.3-14.4 13.6-12.8 16.5 6.1 6.5 3.5 7.1 2.2 1.3 0 1.7-0.3 0.7-0.2 0.8-0.4 0.6-0.7 0.8-1.8 0.7-0.8 0.8-0.4 1-0.3 4.7-0.6 2.1-0.7 2.6-1.6 2.8 7.6 0.1 6.3-0.4 6.6 0.4 2.6 0.7 1.6 1.2 0.1 1.2 0 1.2-0.2 8.9-2.8 1.6-0.1 1.7 0.3 2.9 1.1 1 1.3 9.3 19.8 0.3 1.1 0.1 1.1-0.1 2.5-0.4 2.2-2.9 7.9-0.2 0.9-0.3 0.9-0.3 1.3 0 0.6 0 0.1-1.6 8.4 0 1.8 0.5 6.7 0.5 2.2 0.6 1.6 2.4 2.7 2.3 1.8 3.3 2 2.6 2.5 2.4 3.2 0.9 2 0.4 1.6-0.2 1.2-0.5 2.2-0.3 0.9-0.5 0.9-2.3 1.7-0.6 0.7-0.5 0.8-0.3 1-0.1 1.2-0.1 1.2 1.7 15.8-0.1 2.2-0.5 0.8-0.6 0.7-0.7 0.8-0.8 0.5-3.5 1.7-2.7 1.1-1.7 1-1.5 1.2-0.6 0.7-0.5 0.8-0.5 1-0.3 0.9-0.3 1.1-0.9 11.6 0 0.1-87.6-40.9-26.6-16.4z" id="SVPA" name="La Paz"></path>
          <path class="departamento" d="M520.2 293.8l0.5-11.1 0.7-1.2 1-1.4 2.4 0.1 2.2 0.5 3.9 1.3 2.6-0.4 3.6-1.2 11.7-5.2 2.5-0.6 2.7 0.6 2.2 0.2 1.3-0.8 1.2-1.3 1.9-2.5 1.4-0.7 1.2-0.1 5.4 3.9 1.8 0.5 2.7 0.2 12-0.1 2.4 0.4 5.2 0.3 4.1 0.8 0.9 0.4 6.9 5.1 0.9 0.5 3.9 1.4 2.6 1.5 0.9 0.4 2.6 0.7 1 0.5 0.6 0.9 0.4 2.1 0.3 1 0.5 0.8 0.7 0.6 1.4 0.5 9.5 1.2 3.5 0.9 6.1-4.1 1 9.1 11.6 11.6 4.3 6.8-23.6 17.2-2.1 6.8-5.6 7.7-7.5 4.8-8.3-1.9-10.8 13.4-0.5 2.4-6.2 1.1-2.1 3-0.9 11.7-3.2 11.5-17.1 32.6-1.6 4.1-0.9 4.9-0.5 12-0.9 2.6-6.6 6.4-3.5 5.2-2.2 4.2-3.6 2.9-7.3 1.1-4.5 1.7-2.8 3.8-1.5 5.5 0 0.8 0.2 0.1-5.6-2.6 0-0.1 0.9-11.6 0.3-1.1 0.3-0.9 0.5-1 0.5-0.8 0.6-0.7 1.5-1.2 1.7-1 2.7-1.1 3.5-1.7 0.8-0.5 0.7-0.8 0.6-0.7 0.5-0.8 0.1-2.2-1.7-15.8 0.1-1.2 0.1-1.2 0.3-1 0.5-0.8 0.6-0.7 2.3-1.7 0.5-0.9 0.3-0.9 0.5-2.2 0.2-1.2-0.4-1.6-0.9-2-2.4-3.2-2.6-2.5-3.3-2-2.3-1.8-2.4-2.7-0.6-1.6-0.5-2.2-0.5-6.7 0-1.8 1.6-8.4 0-0.1 0-0.6 0.3-1.3 0.3-0.9 0.2-0.9 2.9-7.9 0.4-2.2 0.1-2.5-0.1-1.1-0.3-1.1-9.3-19.8-1-1.3-2.9-1.1-1.7-0.3-1.6 0.1-8.9 2.8-1.2 0.2-1.2 0-1.2-0.1-0.7-1.6-0.4-2.6 0.4-6.6-0.1-6.3-2.8-7.6 7.3-7.2 0.8-1.3 0.9-1.8 1.3-5.4 6.9-18.3z" id="SVSV" name="San Vicente"></path>
          <path class="departamento" d="M656.4 317.9l15.4-1.8 4.4 0.3 2.3 2.9 3.2 5 2.5 2.4 3.3 2.3 2.9 1 9.2 1.2 2.3 0.7 1.2 1 0 1.1-1.8 5-0.2 1.1 0 1.2 0.7 3.2 1.1 2.7 0.5 1.6 0.2 1.4-0.2 1-0.3 1-0.6 0.8-0.6 0.7-0.8 0.4-2.1 0.7-0.8 0.5-0.6 0.7-0.5 0.8-0.3 1-0.1 1.2 0 2.3 0.2 1.1 0.3 1 4.5 9.6 0.5 1.5 0 0.9-0.8 3 0 1.6 0.3 2 1.5 5.1 0.2 1.5-0.1 0.8-0.5 1-0.1 0.1-2 1.9-0.6 0.7-0.5 0.9-0.3 1-0.1 1.2 0.1 2.3-0.2 2.4-0.4 1-0.5 0.6-0.7 0-0.6-0.5-0.5-0.6-0.4-0.4-0.6-0.2-0.7 0.2-0.6 0.7-0.3 1-0.1 1.2 0.1 1.1 0.6 5.2 0.1 2.5 1.2 7.1 0.4 1.2 0.6 0.4 0.6 0.1 1.8-0.7 1.5 0.5 0.6 1 0.2 1.2-0.1 2.5 0.2 2.3 0.6 3 2 6.9 2 4.1 3.8 6.1 2.6 3.4 0.7 0.5 0.8 0.5 2.8 1.3 2 0.5 7.4 0.8 1.7 1 1.9 1.6 3.3 4 1.6 1.4 1.1 0.8 0.9-0.1 1.1 0.1 0.9 0.4 0.8 0.5 1.5 1.2 0.8 0.5 0.9 0.4 1.1 0.1 1 0 1.1-0.3 1.9-0.8 3.5-1.9 1.2-0.1 1.6 0.2 1.2 1.4 0.7 1.1 0.3 1.2 0.2 1.1 0 5.7 0.9 1.4 1.4 1.2 2.5 1.3 0.9 1.2 0.2 1.1-2.8 5.1-0.4 1.3-0.2 1.2 0.1 1.9 0.7 0.8 0.9 0.2 10.2-1.6 1.2 0.1 1 0.2 1 0.4 23 26.8-3.5 1.4-32.4 2.7-34.8-5.3-9 2.9-4.8-1.6-5.5-1.2 0-2.4 8.5-0.6 0.6-5.9-4.5-7.4-6.9-4.8 1.5 3 4.5 6.3 1.7 3.9-13.6-0.5-6.6 0.7-5.7 2.4 3.7 1.6 2.9-0.5 3.5-1 5.3-0.1 0 2.9-8.7 3.6-9.7-0.3-7.5-4.6-2.3-9.5 3.7 1.7 1.4 0.9 5.2-5.2 0-2.4-6.5-2.9-7-10-4.7-2.9 1.2 5.5 2.2 4.6 1.1 4.1-1.7 4-5.5-3.2-15.9-4-6.8-3.6-6.2-11.1-2.9-1.8-4.4-0.4-12.4-2.5-5.5 0-15.2 2.9-21.2 0.5-4.7 2.1 2.6 2 2.7 1.5 2.8 0.5 2.4-1.1 10.6 2.4 30.2-3.2 3.3 0.5 4.9 2.7 2.6 2.4 4.7 5.7 3.1 2.4 0 2.9-7-1.2-5.1-1-11.2-3.3 0 2.6 30.8 6.3 16.1 5.3 7.2 7.1-2.7 4.6-6.7-1.1-7.5-4-4.9-3.7-5.5-2.8-97-18.1-11.6-5.4-0.2-0.1 0-0.8 1.5-5.5 2.8-3.8 4.5-1.7 7.3-1.1 3.6-2.9 2.2-4.2 3.5-5.2 6.6-6.4 0.9-2.6 0.5-12 0.9-4.9 1.6-4.1 17.1-32.6 3.2-11.5 0.9-11.7 2.1-3 6.2-1.1 0.5-2.4 10.8-13.4 8.3 1.9 7.5-4.8 5.6-7.7 2.1-6.8 23.6-17.2z" id="SVUS" name="Usulut√°n"></path>
          <path class="departamento" d="M410.9 171.4l6.6-3.4 1.2 0 1.3 0.1 4.7 2.4 9.7 3.5 1.9 1.1 2.7 2.4 6.3 4.5 0.6 0.8 1.7 3 8.2 9.8 0.7 1 0.2 0.7 0 0.1-0.3 1.6 0 1.1 0.1 0.9 0.3 1 0.6 1.8 1 2.1 2 2.9 1.7 1.6 1.4 0.9 8 3.8 6.8-0.5 5.8 2.2 6.2 0.7-5.5 8.8-0.4 0.9-1.1 1.6-1.3 1.4-1.4 1.2-5 2.9-0.8 0.6-0.6 0.6-0.6 0.9-0.3 0.9-0.3 1-0.2 1.2 0.9 2.5 1.8 3.3 7.3 10.4 2.3 2.4 3.1 2.1 1.8 2.1 1.4 3 0.3 1.7 0.4 1.6 1.9 3.4 0.5 1.5 0.5 2.5 0.9 1.7 1.5 2 3.6 3.9 2.4 3.7 0.4 1 3.4 1.9 13 3.6-6.9 18.3-1.3 5.4-0.9 1.8-0.8 1.3-7.3 7.2-2.6 1.6-2.1 0.7-4.7 0.6-1 0.3-0.8 0.4-0.7 0.8-0.8 1.8-0.6 0.7-0.8 0.4-0.7 0.2-1.7 0.3-1.3 0-7.1-2.2-6.5-3.5-16.5-6.1-0.3-11.6-0.8-2-0.7-2-1.8-2.3-6.6-12.5-0.5-1.8 0.6-8.3-0.3-1.7-0.7-1.1-1-0.3-1.4-1-1.6-1.6-4.7-7-0.7-0.6-1-0.4-1.1-0.2-2.4-0.1-2.6-2.1-3.4-4-10-15.7-1.1-3 0.7-0.6 2.7-1.2 1-0.7 0.7-0.8 0.7-1.5-0.4-0.8-2.3-3-7.8-12.8-3.5-7.4-0.8-2.9-0.4-3.3 0.2-0.6 0.6-0.5 0.7-0.6 0.7-0.6 1-1.6 0.3-0.9 0.3-1.1 0.3-2.3 0.5-2.1 0.2-1.6 0-0.4 0.1-0.7-0.3-3.7-1.2-6.4-0.1-1.7 0.3-1.2 1.8-3.7 1.7-4.6 0.2-3.8z" id="SVCU" name="Cuscatl√°n"></path>
          
          <!-- Departamentos interactivos -->
          <path class="departamento interactivo" d="M194.1 232.6l7.5-25.9 1.1-6.9-0.3-0.9-0.8-1.5-0.1-0.1-1.3-1.4-1.6-1.2-1.3-1.3-0.6-0.9-0.4-0.9-0.8-3.2-0.4-0.8-0.7-0.8-1.3-1.2-6.8-4.3-3.2-1.3-2.4-5.6-0.3-3 1-3.2 16.1-28.4 7.5-8.2 9.4-7.3 9.9-4.6 40.3-9.7 2.5-2.4-0.1-6-1.2-1.6-4.8-2.4-1.6-1.6-0.7-2.5-0.7-5.9-0.5-1.8-2.2-4.2-1-1.5-2.2-2-2.6-1.2-7.9-1-2.3-5.5 2.2-3.3 3.8-2.7 2.4-3.8-1.1-4.5-2.7-3.8-1.7-4.4 2.5-6.1 5.3-4 5.5 0.5 4.1 4.1 1.1 7.2 5.1-3.7 9.3-11.2 2.6-1.1 4.1-1.8 5.9 0.8 4.3 2.3 4.2 1.5 5.9-1.2 8.6-8.8 3.8-1.5 0.5 7.5 1.9-3 0.4-0.9 10.8 7.9 0.1 0.1 5.8 0.9 14.3 13.4 2.5 2.8 0.5 0.7 1.2 2.9 1.7 2.9 0.8 0.8 1.3 1.1 5.6 2.9 0.8 0.7 1.8 2.4 6.9 4.4-4.8 14-1.5 7.8-3.3 3.7-14 5.7 0 7.7 0.3 4.3-0.1 1.5-0.7 1.8-7.3 10.1-1.3 1.3-0.8 0.6-0.8 0.5-1 0.3-1 0.3-1.2 0.2-3.8 0.2-1 0.2-1 0.3-0.9 0.4-0.8 0.5-0.7 0.6-4.4 8.1-0.9 1.2-0.7 0.7-0.9 0.5-0.9 0.4-7.1-0.5-7.2 24.8 1.1 8.4 4.2 3.8 5.6 1.1 5.6 0 4.4-1.2-4 21.4-0.7 5.5 0.1 1.2-0.6 7.5-0.4 1.2-0.8 1-1.9 0.9-1.4 0-1.3 0-1 0.1-0.8 0.4-3 4.9-1.2 0.8-1.1 0.1-0.9-0.3-1-0.1-0.9 0.3-0.8 0.5-0.6 0.8-0.5 2.1-0.5 10.4 0.4 6.9-0.7 8.3-6.6 18-1.8 10.7-17.9-3.4-4.7-1.6-0.6-0.8-0.6-0.8-2.2-5.6-5-4.7-8-5.9-3.6-2.2-2.5-1.1-1 0.2-0.8 0.6-0.6 0.7-1 1.6-1.2 2.8-0.5 2.1 0 3.5-0.3 0.9-0.8 0.9-1.4 0.7-2.7 0.6-1.7-0.4-1.2-0.4-0.9-0.7-0.6-0.7-0.5-0.9-0.4-1.2-0.9-1.3-1.7-1.8-2.4-0.4-1.2-0.8-0.5-0.8 0.2-1 0.4-0.8 0.7-0.8 1.4-1.2 0.6-0.6 0.5-0.9 0.3-1.1 0.1-1-0.4-2-1.7-2.8-2.3-2.1-1.2-1.3-0.8-1.1-1.2-2.8-1.1-1.5-6.1-6-2.2-1.6-1.7-0.8-1.2 0-1.1 0.1-2.1 0.6-3.4 0.1-8.7-2.2z" id="santa-ana" name="Santa Ana"></path>
          <path class="departamento interactivo" d="M106 326.8l0.9-1.4 5.9-9.4 2.8-3.4 1.1-0.9 0.9-0.6 1.1-0.5 1.3-0.4 2.1-0.4 1.5 0 1.4 0.1 1 0.4 0.9 0.4 1.5 1.1 0.8 0.6 4.9 5.7 2.7 2.6 0.8 0.5 2.3 0.5 11.3 0.7 3.1-0.4 1.9-0.8 2.1-8.6 0.7-1.9 4.8-8.6 0.3-1 0.3-3.6 0.6-1.6 1.1-2.1 2.8-3.4 1.1-1.8 0.5-1.5-0.4-2.2-3.1-10 0.2-1.6 0.7-2.1 7.6-11.7 0.2-1.3-0.3-0.9-0.9-1.8-0.7-1.7-0.6-2.3-0.9-7.2 0.1-1.6 0.4-2.5 0.8-1.1 1-0.7 4.6-0.7 8.2-2.3 6.7-2.8 8.7 2.2 3.4-0.1 2.1-0.6 1.1-0.1 1.2 0 1.7 0.8 2.2 1.6 6.1 6 1.1 1.5 1.2 2.8 0.8 1.1 1.2 1.3 2.3 2.1 1.7 2.8 0.4 2-0.1 1-0.3 1.1-0.5 0.9-0.6 0.6-1.4 1.2-0.7 0.8-0.4 0.8-0.2 1 0.5 0.8 1.2 0.8 2.4 0.4 1.7 1.8 0.9 1.3 0.4 1.2 0.5 0.9 0.6 0.7 0.9 0.7 1.2 0.4 1.7 0.4 2.7-0.6 1.4-0.7 0.8-0.9 0.3-0.9 0-3.5 0.5-2.1 1.2-2.8 1-1.6 0.6-0.7 0.8-0.6 1-0.2 2.5 1.1 3.6 2.2 8 5.9 5 4.7 2.2 5.6 0.6 0.8 0.6 0.8 4.7 1.6 17.9 3.4 4.3 1.4 0.9 0.4 0.8 0.6 0.7 0.6 0.5 0.8 0.3 1 0.2 1-0.5 1.5-1 1.5-2.7 2.4-2.4 1.7-5.5 3.2-2.1 1.9-4.4 5.5-1.5 1.2-1.5 0.6-2.6 0.3-0.9 0.2-1.5 0.9-0.8 0.7-0.8 1.4-0.8 2.1-1.1 4.6-0.6 4.5 0.5 8.5-0.1 1.3-1 1.8-1.9 2.6-8.2 8.2-0.7 0.5-0.8 0.8-0.9 1.2-0.8 1.9-0.7 3.2-0.5 4.7-1.1 1.5-1.6 1.9-9.5 8.4-2 3.2-4 9.1-1 2.5-2.6-0.6-23.8-7.8-12.6 2.6-35.6 0.4-5.7-3.9-3.8-14.2-1.4-8.9-4.7-3.9-7.8-4.8-30.4-17.3-0.8-0.4z" id="sonsonate" name="Sonsonate"></path>
          <path class="departamento interactivo" d="M363.6 177.2l2.7 0.4 1.5-0.8 4.9-3.5 2.9-1 7.8 3.4 5.2 0.1 2.4-4.8 5.3 4.2 4.2 1 10.4-4.8-0.2 3.8-1.7 4.6-1.8 3.7-0.3 1.2 0.1 1.7 1.2 6.4 0.3 3.7-0.1 0.7 0 0.4-0.2 1.6-0.5 2.1-0.3 2.3-0.3 1.1-0.3 0.9-1 1.6-0.7 0.6-0.7 0.6-0.6 0.5-0.2 0.6 0.4 3.3 0.8 2.9 3.5 7.4 7.8 12.8 2.3 3 0.4 0.8-0.7 1.5-0.7 0.8-1 0.7-2.7 1.2-0.7 0.6 1.1 3 10 15.7 3.4 4 2.6 2.1 2.4 0.1 1.1 0.2 1 0.4 0.7 0.6 4.7 7 1.6 1.6 1.4 1 1 0.3 0.7 1.1 0.3 1.7-0.6 8.3 0.5 1.8 6.6 12.5 1.8 2.3 0.7 2 0.8 2 0.3 11.6-13.6 12.8-11.3 14.4-1.9 1.5-1.1-0.1-1.2-0.2-6-1.9-1.1-0.2-1.2 0-1 0.2-0.9 0.5-0.5 1.2-0.2 1.8 0.7 3.3 1.1 3.1 2.9 5.1 0.7 1.9-0.2 2.7-0.8 4.2-3.2 9.6-1.9 4.1-2.7 3-1.1 0.7-0.8 3.2-2.8-1.2-1-0.3-1.4-0.2-2.2 0.3-3.9 1.3-2.1 0.5-1.2 0.1-1.1-0.2-0.8-0.4-0.6-0.7-2.1-4.6-6-9.8-0.2-1.4 0.1-1.8 0.8-3.4 2.4-6.1 0.2-1.2-0.7-15.9 0.2-3.7 0.6-2.2 0.7-0.6 0.6-0.7 0.2-0.9-0.4-0.9-2.9-1.4-0.8-0.8-0.1-1.2 0.9-2.2 1.2-2.3 0.2-1.2-0.4-1.4-2.5-3.4-1.6-1.4-0.7-0.5-5.4-2.9-0.8-0.6-0.7-1.1-0.6-1.7-0.7-3-0.4-1.3-0.7-0.9-1.5-1.1-0.6-0.7-0.5-0.8-0.4-1-0.3-3.7 0.4-3.8-1.9-2.5-1.2-0.1-1-0.3-0.6-0.8-0.2-1.5 1.7-4.8 2.6-4.9 0.3-1 0.3-1.6 0.4-6.2 0.7-3.6 1.2-2.8 0.8-3 0.7-6.8 0.5-1.8 0.7-1.9 1.2-1.4 0.7-0.6 0.9-0.5 1.9-0.7 0.8-0.5 0.4-0.9 0.5-2.2 1.9-21.6 0.4-1.2 0.7-0.7 1-0.3 2.8 0.1 0.3-0.3 0.1-0.4 0.5-2.2 1-2.6-0.1-0.6-0.6-0.8-2-1.1-1.4-1.1-1.2-0.7-1-0.4-1.1-0.2-1.1-0.2-1.2 0-3.5 0.3-1.1-0.1-3-0.9-1.8-0.9-1.6-1-1-1.4-1.1-2.1-1.9-4.4-1.1-2-0.9-1.3-2.3-1.8-0.2-1.4 0.1-2.1 2-8.3 0.4-13z" id="san-salvador" name="San Salvador"></path>
          <path class="departamento interactivo" d="M639.5 290.4l0-0.1 3.4-6.7 3.5-5.4-0.8-5.3 4.1-2.6 2.6-3.9 0.6-4.6-2.4-4.8 1.7-1.5 0.7-0.6 10-0.5 7-4.3 6.8-2.9 15.2-3.3 3.5 0.2 6 2.3 2.8 0.3 0.4-1.1 0-2.3 0.3-2.4 1.2-1.4 2.4-0.1 3 0.5 3 0.9 2.4 1 2.6-4.8 4.1-1.5 4.5-0.4 4.1-1.4 3-2.8 1.2-2.3 2.1 2.9 4.4 10.4 0.7 3.1 0.1 1.3 0.6 1.7 1.5 2.9 1.2 3.2 0 2.3-0.2 1.1-0.4 1-0.4 0.8-0.6 0.8-0.6 0.7-0.8 0.5-0.7 0.6-1.1 1.4-0.5 0.8-0.2 0.7-0.2 0.7-0.3 2.1 0.1 3.8 0.3 1 0.3 1 1.4 1.5 2.1 1.9 14.2 9.7 0.8 1 1 1.5 0.7 2.3 0 1.4-0.3 1.1-0.6 0.7-0.7 0.7-0.9 0.5-2.9 1-1.7 1-12.3 8.9-0.7 0.7-0.4 0.8 0 1 0.6 9.7 1.2 1.8 1.9 2.3 4.8 4.3 1.2 1.9 0.7 2.3 1.4 1.4 3.5 2.6 1.4 1.9 0.8 1.5 0.2 1.1 0.3 1.1 0.3 0.9 0.6 0.7 0.8 0.7 2.7 1.7 0.9 0.9 0.6 1-0.1 1-0.4 0.9-2.2 3-0.5 0.9 0.1 0.6 0.6 0.5 2.1-0.6 3-1.8 1.9-0.8 2.1-0.4 14.6-1.2 1.4 0.5 1.3 0.8 1.6 2.1 1.4 2.6 0.6 2.1 1.1 6.9 0.4 0.8 0.6 0.8 0.8 0.6 5.5 3.3 1.3 1.2 0.9 1 0.3 0.8 0.6 1.1 0.6 0.6 1.8 0.3 2.8-0.3 14.7-4.6 3.9-0.2 8.1 1.3-2.5 3.3-0.8 4.9 0.2 11.7 1.5 5.6 0 1.2-0.4 1.3-1.4 1.7-1.1 0.9-1 0.8-1.6 0.9-0.7 0.6-0.6 1.5-0.3 2.5 0.2 9.9 1.1 6.8 0.3 1 0.5 0.9 3.5 5.6 0.4 0.9 0.4 1 0.1 0.9-4.8 27.8 0.1 1.6 0.6 2.2-0.3 2.4-4.9 16.1-0.8 0.9-1.8 0.5-1.2 0-1.3-0.3-3.9-1.4-3.2-1.9-3.1-2.3-0.8-0.3-1 3.8-0.5 2.9-2.1 30.2 0 0.1-2.6-0.5-2.5 0-2.8 1.1-23-26.8-1-0.4-1-0.2-1.2-0.1-10.2 1.6-0.9-0.2-0.7-0.8-0.1-1.9 0.2-1.2 0.4-1.3 2.8-5.1-0.2-1.1-0.9-1.2-2.5-1.3-1.4-1.2-0.9-1.4 0-5.7-0.2-1.1-0.3-1.2-0.7-1.1-1.2-1.4-1.6-0.2-1.2 0.1-3.5 1.9-1.9 0.8-1.1 0.3-1 0-1.1-0.1-0.9-0.4-0.8-0.5-1.5-1.2-0.8-0.5-0.9-0.4-1.1-0.1-0.9 0.1-1.1-0.8-1.6-1.4-3.3-4-1.9-1.6-1.7-1-7.4-0.8-2-0.5-2.8-1.3-0.8-0.5-0.7-0.5-2.6-3.4-3.8-6.1-2-4.1-2-6.9-0.6-3-0.2-2.3 0.1-2.5-0.2-1.2-0.6-1-1.5-0.5-1.8 0.7-0.6-0.1-0.6-0.4-0.4-1.2-1.2-7.1-0.1-2.5-0.6-5.2-0.1-1.1 0.1-1.2 0.3-1 0.6-0.7 0.7-0.2 0.6 0.2 0.4 0.4 0.5 0.6 0.6 0.5 0.7 0 0.5-0.6 0.4-1 0.2-2.4-0.1-2.3 0.1-1.2 0.3-1 0.5-0.9 0.6-0.7 2-1.9 0.1-0.1 0.5-1 0.1-0.8-0.2-1.5-1.5-5.1-0.3-2 0-1.6 0.8-3 0-0.9-0.5-1.5-4.5-9.6-0.3-1-0.2-1.1 0-2.3 0.1-1.2 0.3-1 0.5-0.8 0.6-0.7 0.8-0.5 2.1-0.7 0.8-0.4 0.6-0.7 0.6-0.8 0.3-1 0.2-1-0.2-1.4-0.5-1.6-1.1-2.7-0.7-3.2 0-1.2 0.2-1.1 1.8-5 0-1.1-1.2-1-2.3-0.7-9.2-1.2-2.9-1-3.3-2.3-2.5-2.4-3.2-5-2.3-2.9-4.4-0.3-15.4 1.8-4.3-6.8-11.6-11.6-1-9.1z" id="san-miguel" name="San Miguel"></path>
        </svg>
      </div>

      <div class="cta-box" id="ctaClick">
        <div style="font-size:18px">üìç</div>
        <div>
          <div style="font-weight:700">Explora nuestras sedes</div>
          <div style="font-size:13px;opacity:.95">Haz clic en cada departamento para ver detalles</div>
        </div>
        <div class="hand">üñ±Ô∏è</div>
      </div>
    </section>

    <!-- Derecha: estad√≠sticas globales -->
    <aside class="stats-panel" aria-label="Estad√≠sticas generales del programa">
      <div style="margin-bottom:10px"><strong>Impacto en J√≥venes y Educaci√≥n</strong></div>

        <div class="stat-card">
        <div class="icon"><i class="fa-solid fa-users"></i></div>
        <div>
          <div class="num">389</div>
          <div class="text">J√≥venes Impactados</div>
        </div>
      </div>

      <div class="stat-card">
        <div class="icon"><i class="fa-solid fa-school"></i></div>
        <div>
          <div class="num">394</div>
          <div class="text">Jovenes matriculados</div>
        </div>
      </div>

      <div class="stat-card">
        <div class="icon"><i class="fa-solid fa-user-graduate"></i></div>
        <div>
          <div class="num">301</div>
          <div class="text">Becas otorgadas</div>
        </div>
      </div>

      <div class="stat-card">
        <div class="icon"><i class="fa-solid fa-university"></i></div>
        <div>
          <div class="num">40</div>
          <div class="text">Universidades con alianzas</div>
        </div>
       </aside>
    <!-- Bot√≥n para mostrar la gr√°fica matem√°tica -->
<!-- Bot√≥n para mostrar la gr√°fica matem√°tica -->
<button id="btnGrafica"
  style="
    margin-top:8px;   /* ‚Üê MENOS ESPACIO */
    width:100%;
    background:#eb2525;
    color:white;
    padding:10px 14px; /* ‚Üê M√ÅS COMPACTO */
    border:none;
    border-radius:10px;
    font-size:15px;
    cursor:pointer;
    box-shadow:0 4px 12px rgba(0,0,0,.12);
    transition:transform .25s ease, box-shadow .25s ease;
  "
  onmouseover="this.style.transform='scale(1.03)'; this.style.boxShadow='0 8px 18px rgba(0,0,0,.18)'"
  onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,.12)'"
>
  üîç Consultar gr√°ficas globales
</button>
<!-- ======================= MODAL DE GR√ÅFICA MATEM√ÅTICA ======================= -->
<div id="modalGrafica" 
     style="
        display:none;
        position:fixed;
        inset:0;
        background:rgba(0,0,0,0.45);
        backdrop-filter:blur(4px);
        z-index:3000;
        justify-content:center;
        align-items:center;
        animation: fadeIn .35s ease;
     ">

  <div style="
      width:min(850px, 92%);
      background:white;
      border-radius:18px;
      padding:24px;
      box-shadow:0 20px 60px rgba(0,0,0,.25);
      display:flex;
      flex-direction:column;
      gap:18px;
      transform:scale(0.95);
      animation: modalPop .35s ease forwards;
  ">

    <!-- Header con icono -->
    <div style="display:flex; justify-content:space-between; align-items:center;">
      <div style="display:flex; align-items:center; gap:10px;">
        <div style="
          background:#b41f1f;
          color:white;
          width:42px; height:42px;
          display:flex; align-items:center; justify-content:center;
          border-radius:12px;
          font-size:20px;
          box-shadow:0 4px 12px rgba(0,0,0,.2);
        ">üìä</div>

        <h2 style="margin:0; font-size:22px; font-weight:800; color:#b41f1f;">
          Gr√°fica Matem√°tica
        </h2>
      </div>

      <button id="cerrarGrafica"
        style="
          background:#ffffff;
          border:1px solid #ccc;
          padding:8px 12px;
          border-radius:10px;
          cursor:pointer;
          font-weight:700;
          transition:.2s;
        "
        onmouseover="this.style.background='#f3f3f3'"
        onmouseout="this.style.background='white'">
        ‚úï
      </button>
    </div>

    <!-- Filtros elevados -->
    <div style="display:flex; gap:12px; margin-top:4px;">
      <button class="filtroBtn" data-filtro="genero"
        style="
          padding:10px 16px; border-radius:10px; border:none;
          background:#edd1d1; cursor:pointer; font-weight:600;
          box-shadow:0 4px 12px rgba(0,0,0,.08);
          transition:.25s;
        "
        onmouseover="this.style.transform='scale(1.05)';"
        onmouseout="this.style.transform='scale(1)';">
        üë©‚Äçüßë G√©nero
      </button>

      <button class="filtroBtn" data-filtro="edad"
        style="
          padding:10px 16px; border-radius:10px; border:none;
          background:#edd1d1; cursor:pointer; font-weight:600;
          box-shadow:0 4px 12px rgba(0,0,0,.08);
          transition:.25s;
        "
        onmouseover="this.style.transform='scale(1.05)'"
        onmouseout="this.style.transform='scale(1)'">
        üéì Edad
      </button>

      <button class="filtroBtn" data-filtro="zona"
        style="
          padding:10px 16px; border-radius:10px; border:none;
          background:#edd1d1; cursor:pointer; font-weight:600;
          box-shadow:0 4px 12px rgba(0,0,0,.08);
          transition:.25s;
        "
        onmouseover="this.style.transform='scale(1.05)'"
        onmouseout="this.style.transform='scale(1)'">
        üó∫Ô∏è Zona
      </button>
    </div>

    <!-- Gr√°fica -->
    <div style="
      margin-top:10px;
      height:340px;
      border-radius:12px;
      padding:18px;
      background:white;
      background-image:
        linear-gradient(to right, rgba(0,0,0,0.04) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(0,0,0,0.04) 1px, transparent 1px);
      background-size:26px 26px;
      box-shadow:0 4px 12px rgba(0,0,0,.08);
    ">
      <canvas id="lineChart"></canvas>
    </div>

    <!-- Explicaci√≥n Matem√°tica -->
    <div style="
        margin-top:8px;
        background:#fff8f8;
        border-left:5px solid #b41f1f;
        padding:16px 20px;
        border-radius:10px;
        box-shadow:0 4px 14px rgba(0,0,0,.08);
    ">
      <h3 style="margin:0 0 6px; font-size:18px; font-weight:700;">
        üìê Explicaci√≥n
      </h3>
      <p id="explicacionTexto" style="margin:0; color:#444; font-size:15px;">
        üîçSelecciona un filtro para ver su interpretaci√≥n matem√°tica.
      </p>
    </div>

  </div>
</div>

<!-- Animaciones -->
<style>
@keyframes fadeIn {
  from {opacity:0;}
  to {opacity:1;}
}
@keyframes modalPop {
  from {transform:scale(0.92);}
  to {transform:scale(1);}
}
</style>
<!-- ======================= FIN DEL MODAL ======================= -->

  </main>
  <!-- Overlay: secci√≥n departamento -->
  <div id="seccion-departamento" role="dialog" aria-hidden="true">
    <div class="detalle" role="document">
      <div class="left">
        <div class="silhouette" id="silhouette"
             style="background-image: url('1.jpg'); background-size:cover;"></div>
        <h3 id="dept-title">Sede - Nombre</h3>
        <div style="font-size:13px; color:#444; text-align:center; padding:6px;">Sede local del Programa Oportunidades</div>
      </div>

      <div class="right">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="font-weight:700; font-size:18px">Detalles de la sede</div>
          <div class="close-detail" id="closeDept">Cerrar ‚úï</div>
        </div>

        <div class="desc" id="dept-desc">
          <!-- Texto descriptivo cargado por JS -->
        </div>

        <div class="stats-list" id="dept-stats">
          <!-- Lista de estad√≠sticas destacadas -->
        </div>

        <div style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
          <div style="flex:1">
            <input id="searchInput" placeholder="Buscar..." style="width:100%;padding:8px;border-radius:8px;border:1px solid #ddd">
          </div>
          <div style="width:180px; text-align:right">
            <button id="backToMap" style="padding:8px 12px;border-radius:8px;border:1px solid #ddd;background:#fff;cursor:pointer">
              Volver al mapa
            </button>
          </div>
        </div>

        <div class="chart-area">
          <div style="display:flex;align-items:center;justify-content:space-between">
            <div style="display:flex; gap:12px; align-items:center;">
              <strong>Gr√°fico de estad√≠sticas (2019‚Äì2024)</strong>
              <div class="slope-badge" id="slopeBadge" title="Pendiente promedio">
                <span class="icon">üìà</span>
                <span id="slopeText">Pendiente: ‚Äî</span>
              </div>
            </div>
            <div class="chart-controls" id="chartControls">
              <button data-filter="impactados" class="active">J√≥venes impactados</button>
              <button data-filter="matriculas">Matriculas</button>
              <button data-filter="becas">Becas</button>
              <button data-filter="desercion">Deserciones</button>
            </div>
          </div>
          <canvas id="graficoEstadisticas" style="max-height:380px;width:100%;"></canvas>

          <!-- Nota matem√°tica sobre pendiente -->
          <div class="chart-note" id="chartNote">
            La <strong>pendiente</strong> de esta l√≠nea representa la <strong>tasa de cambio</strong> de la m√©trica seleccionada a lo largo del tiempo. Una pendiente positiva indica crecimiento; una pendiente negativa indica reducci√≥n.
          </div>
        </div>
      </div>
    </div>
  </div>
  <footer style="text-align:center;padding:20px 12px;opacity:.85;">
    ¬© 2025 Programa Oportunidades ‚Äî Proyecto Matem√°tico
  </footer>
<script>
  // ---------- Datos simulados por departamento (2019 a 2024) ----------
  const DATA = {
    "Santa Ana": {
      desc: "La sede de Santa Ana acompa√±a a j√≥venes de la zona occidental, brindando formaci√≥n t√©cnica y apoyo acad√©mico.",
      stats: [
        "M√°s de 500 estudiantes activos",
        "120 becas otorgadas en 2025",
        "Tasa de deserci√≥n reducida en un 15%",
        "40 docentes involucrados"
      ],
      silhouette: "2.jpg",
      charts: {
        impactados: [50, 65, 80, 95, 110, 130],
        matriculas: [70, 78, 85, 92, 102, 110],
        becas: [8, 12, 18, 24, 30, 42],
        desercion: [9, 8, 7, 6, 5, 4]
      }
    },
    "Sonsonate": {
      desc: "La sede de Sonsonate impulsa formaci√≥n t√©cnico-pr√°ctica y conexi√≥n con empresas locales.",
      stats: [
        "Aprox. 420 estudiantes activos",
        "95 becas otorgadas en 2025",
        "Programas de formaci√≥n dual en 12 empresas",
        "30 docentes capacitados"
      ],
      silhouette: "1.jpg",
      charts: {
        impactados: [30, 45, 58, 68, 80, 96],
        matriculas: [55, 65, 73, 82, 90, 98],
        becas: [6, 9, 13, 17, 22, 28],
        desercion: [11, 10, 9, 8, 7, 5]
      }
    },
    "San Salvador": {
      desc: "La sede San Salvador ofrece formaci√≥n t√©cnica avanzada y redes con instituciones educativas.",
      stats: [
        "M√°s de 1,200 estudiantes atendidos",
        "450 colocaciones en programas de pasant√≠as",
        "200 becas para formaci√≥n t√©cnica",
        "60 docentes en programas de actualizaci√≥n"
      ],
      silhouette: "1.jpg",
      charts: {
        impactados: [200, 240, 290, 330, 380, 440],
        matriculas: [210, 230, 250, 275, 300, 330],
        becas: [25, 40, 65, 85, 110, 150],
        desercion: [14, 13, 12, 11, 9, 7]
      }
    },
    "San Miguel": {
      desc: "La sede San Miguel se centra en la formaci√≥n en oficios y la inserci√≥n laboral en la zona oriente.",
      stats: [
        "M√°s de 650 estudiantes activos",
        "200 colocaciones laborales en 2025",
        "150 becas de estudio t√©cnico",
        "45 alianzas con empresas locales"
      ],
      silhouette: "2.jpg",
      charts: {
        impactados: [70, 90, 115, 140, 165, 195],
        matriculas: [75, 88, 104, 120, 137, 155],
        becas: [10, 15, 22, 30, 40, 55],
        desercion: [10, 9, 8, 7, 6, 4]
      }
    }
  };

  // Chart.js instance
  let chart = null;
  let currentDept = null;
  let currentFilter = 'impactados';

  // UTIL: abrir detalle
  function openDept(deptName){
    const info = DATA[deptName];
    if(!info) return;
    currentDept = deptName;
    
    // Remover clase seleccionada de todos los departamentos
    document.querySelectorAll('.departamento').forEach(dept => {
      dept.classList.remove('seleccionado');
    });
    
    // A√±adir clase seleccionada al departamento clickeado
    const selectedDept = document.getElementById(deptName.toLowerCase().replace(' ', '-'));
    if(selectedDept) {
      selectedDept.classList.add('seleccionado');
    }
    
    // set title, desc, list
    document.getElementById('dept-title').textContent = `Sede ${deptName}`;
    document.getElementById('dept-desc').innerHTML = `<p style="margin:0">${info.desc}</p>`;
    const statsHtml = info.stats.map(s=>`<li style="margin:8px 0">‚Ä¢ ${s}</li>`).join('');
    document.getElementById('dept-stats').innerHTML = `<ul style="padding-left:12px;margin:0">${statsHtml}</ul>`;
    // silhouette - assume in same folder
    const sil = document.getElementById('silhouette');
    sil.style.backgroundImage = `url('${info.silhouette}')`;
    // show overlay
    const overlay = document.getElementById('seccion-departamento');
    overlay.style.display = 'flex';
    overlay.setAttribute('aria-hidden','false');
    // init chart: default impactados
    currentFilter = 'impactados';
    setActiveFilterButton(currentFilter);
    renderChartFor(currentDept, currentFilter);
  }

  function closeDept(){
    document.getElementById('seccion-departamento').style.display = 'none';
    document.getElementById('seccion-departamento').setAttribute('aria-hidden','true');
    
    // Remover clase seleccionada al cerrar
    document.querySelectorAll('.departamento').forEach(dept => {
      dept.classList.remove('seleccionado');
    });
  }

  // ---------- FUNCI√ìN PRINCIPAL: renderChartFor (mejorada) ----------
  function renderChartFor(deptName, filter){
    const info = DATA[deptName];
    if(!info) return null;

    // Etiquetas de a√±os (X)
    const labels = ['2019','2020','2021','2022','2023','2024'];
    const startYear = Number(labels[0]);
    const endYear = Number(labels[labels.length - 1]);
    const yearsDiff = endYear - startYear; // 5

    // Datos (clon)
    const data = (info.charts[filter] || []).slice();

    // Mapas y unidades
    const labelMap = {
      impactados: 'J√≥venes Impactados',
      matriculas: 'Matr√≠culas',
      becas: 'Becas Otorgadas',
      desercion: 'Tasa de Deserci√≥n'
    };
    const yTitleMap = {
      impactados: 'Cantidad de J√≥venes',
      matriculas: 'Cantidad de Matr√≠culas',
      becas: 'Cantidad de Becas',
      desercion: 'Porcentaje / N¬∫'
    };
    const unitMap = {
      impactados: 'j√≥venes/a√±o',
      matriculas: 'matr√≠culas/a√±o',
      becas: 'becas/a√±o',
      desercion: 'puntos/a√±o'
    };

    // Colores: preferencia por l√≠nea roja tipo marcador para m√©tricas de crecimiento
    const red = 'rgba(220,53,69,1)';
    const redFill = 'rgba(220,53,69,0.08)';
    const blue = 'rgba(33, 150, 243, 1)';
    const blueFill = 'rgba(33,150,243,0.08)';
    const highlightColor = 'rgba(246,200,95,1)'; // dorado para mayor crecimiento

    const isDesercion = (filter === 'desercion');
    const lineColor = isDesercion ? blue : red;
    const areaFill  = isDesercion ? blueFill : redFill;

    // C√°lculo de pendiente promedio m = (y_final - y_inicial) / (x_final - x_inicial)
    const firstY = data[0] ?? 0;
    const lastY  = data[data.length - 1] ?? 0;
    const pendiente = (lastY - firstY) / (yearsDiff || 1);
    const pendRounded = Math.round(pendiente * 100) / 100;

    // Calcular incrementos a√±o a a√±o y detectar mayor crecimiento
    const deltas = [];
    for(let i=1;i<data.length;i++){
      deltas.push(data[i] - data[i-1]);
    }
    // Si todos los deltas negativos, maxDiff ser√° el menos negativo (pero buscamos "mayor incremento")
    let maxDiff = -Infinity;
    let maxDiffIndex = -1; // index of the year where growth happened (i)
    deltas.forEach((d, idx) => {
      if (d > maxDiff) { maxDiff = d; maxDiffIndex = idx + 1; } // +1 to map to the year index (data index)
    });
    // If no positive increments, still highlight the largest (could be reduction less negative)
    if(maxDiffIndex === -1) maxDiffIndex = 0;

    // Preparar arrays para colores y radios por punto, marcando el mayor crecimiento
    const pointBg = data.map((v,i) => (i === maxDiffIndex ? highlightColor : lineColor));
    const pointRadius = data.map((v,i) => (i === maxDiffIndex ? 8 : 5));
    const pointBorderColor = data.map((v,i) => (i === maxDiffIndex ? '#8a5c10' : '#fff'));

    // Ajustes para que el canvas no se corte: layout padding + maintainAspectRatio: false
    const ctx = document.getElementById('graficoEstadisticas').getContext('2d');
    if(chart) chart.destroy();

    chart = new Chart(ctx, {
      type: 'line',
      data: {
        labels,
        datasets: [{
          label: labelMap[filter] || 'Evoluci√≥n',
          data,
          borderColor: lineColor,
          backgroundColor: areaFill,
          borderWidth: 3,
          pointRadius: pointRadius,
          pointBackgroundColor: pointBg,
          pointBorderColor: pointBorderColor,
          pointBorderWidth: 2,
          pointHoverRadius: 9,
          tension: 0.12,
          fill: true
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        layout: {
          padding: { top: 18, right: 18, bottom: 18, left: 6 }
        },
        scales: {
          x: {
            title: {
              display: true,
              text: 'A√±o (X)',
              font: { weight: '700' }
            },
            grid: {
              color: 'rgba(200,215,235,0.9)',
              drawBorder: false
            },
            ticks: {
              maxRotation: 0,
              autoSkip: false
            }
          },
          y: {
            beginAtZero: true,
            title: {
              display: true,
              text: yTitleMap[filter] || 'Valor (Y)',
              font: { weight: '700' }
            },
            grid: {
              color: 'rgba(200,215,235,0.9)',
              borderDash: [2,2]
            },
            ticks: {
              // ensure some breathing room so points are not cut
              callback: function(value){ return value; }
            }
          }
        },
        plugins: {
          legend: {
            display: true,
            position: 'top'
          },
          tooltip: {
            enabled: true,
            mode: 'nearest',
            intersect: true,
            callbacks: {
              title: function(items){
                return `A√±o: ${items[0].label}`;
              },
              label: function(ctx){
                const idx = ctx.dataIndex;
                const val = ctx.parsed.y;
                // show delta relative to previous year if available
                let deltaText = '';
                if(idx > 0){
                  const delta = val - (ctx.chart.data.datasets[0].data[idx-1]);
                  const sign = delta >= 0 ? '+' : '';
                  deltaText = ` (Cambio vs a√±o anterior: ${sign}${Math.round(delta*100)/100})`;
                } else {
                  deltaText = ' (Punto inicial)';
                }
                return `${ctx.dataset.label}: ${val}${deltaText}`;
              },
              afterBody: function(ctx){
                // Add partial slope between this point and previous (if exists)
                const idx = ctx[0].dataIndex;
                if(idx > 0){
                  const y1 = ctx[0].chart.data.datasets[0].data[idx-1];
                  const y2 = ctx[0].parsed.y;
                  const x1 = Number(labels[idx-1]);
                  const x2 = Number(labels[idx]);
                  const slopePartial = Math.round(((y2 - y1) / (x2 - x1)) * 100) / 100;
                  return `Pendiente parcial: ${slopePartial} ${unitMap[filter]}`;
                }
                return '';
              }
            }
          }
        },
        elements: {
          point: {
            hoverBorderWidth: 3
          },
          line: {
            tension: 0.12
          }
        },
        interaction: {
          mode: 'nearest',
          axis: 'x',
          intersect: false
        }
      }
    });

    // Actualizar el badge de pendiente (visible)
    const slopeBadge = document.getElementById('slopeText');
    const sign = pendRounded > 0 ? '+' : '';
    const unit = unitMap[filter] || 'unidad/a√±o';
    slopeBadge.innerText = `Pendiente promedio: ${sign}${pendRounded} ${unit}`;

    // Actualizar nota explicativa con f√≥rmula y detalle
    const noteEl = document.getElementById('chartNote');
    noteEl.innerHTML = `
      <strong>Interpretaci√≥n matem√°tica de la Tendencia:</strong>
      <br>El gr√°fico es un <strong>Plano Cartesiano</strong> (A√±o vs. Valor).
      <br>La <strong>Pendiente promedio</strong> calculada es <strong>${sign}${pendRounded} ${unit}</strong>.
      <br>F√≥rmula aplicada: m = (y_final - y_inicial) / (x_final - x_inicial) = (${lastY} - ${firstY}) / (${endYear} - ${startYear}) = ${Math.round(pendiente*100)/100}.
      <br><em>‚Ä¢ Punto destacado:</em> ${labels[maxDiffIndex]} ‚Äî "Mayor crecimiento" (incremento de ${Math.round(maxDiff*100)/100} unidades respecto al a√±o anterior).
    `;

    // Visual cue: change badge color if negative (desercion reduction)
    const badgeParent = document.getElementById('slopeBadge');
    if(pendiente < 0){
      badgeParent.style.border = '1px solid rgba(33,150,243,0.12)';
      badgeParent.style.background = '#f6fbff';
      document.getElementById('slopeText').className = 'negative-slope';
    } else {
      badgeParent.style.border = '1px solid rgba(220,53,69,0.06)';
      badgeParent.style.background = '#fff8f8';
      document.getElementById('slopeText').className = 'positive-slope';
    }

    // Return slope if needed programmatically
    return { pendiente };
  }

  // Set active filter UI
  function setActiveFilterButton(filter){
    document.querySelectorAll('#chartControls button').forEach(btn=>{
      btn.classList.toggle('active', btn.dataset.filter === filter);
    });
  }

  // Attach click handlers to svg paths and markers
  function setupMapListeners(){
    const interactive = document.querySelectorAll('.departamento.interactivo');
    interactive.forEach(el=>{
      el.addEventListener('click', (ev)=>{
        const deptName = el.getAttribute('name');
        if(deptName) openDept(deptName);
      });
    });
  }

  // Chart control buttons
  document.getElementById('chartControls').addEventListener('click', (e)=>{
    const btn = e.target.closest('button');
    if(!btn) return;
    const filter = btn.dataset.filter;
    if(!filter) return;
    currentFilter = filter;
    setActiveFilterButton(filter);
    if(currentDept){
      renderChartFor(currentDept, filter);
    }
  });

  // Back / close
  document.getElementById('closeDept').addEventListener('click', closeDept);
  document.getElementById('backToMap').addEventListener('click', closeDept);

  // CTA click scroll to map (for demo)
  document.getElementById('ctaClick').addEventListener('click', ()=>{
    document.getElementById('mapWrap').scrollIntoView({behavior:'smooth', block:'center'});
  });

  // Search field (simple highlight demo)
  document.getElementById('searchInput').addEventListener('input', (e)=>{
    const q = e.target.value.trim().toLowerCase();
    if(!currentDept) return;
    const info = DATA[currentDept];
    const matched = info.stats.filter(s => s.toLowerCase().includes(q));
    document.getElementById('dept-stats').innerHTML = matched.length ? `<ul style="padding-left:12px;margin:0">${matched.map(s=>`<li style="margin:8px 0">‚Ä¢ ${s}</li>`).join('')}</ul>` : `<div style="opacity:.7">No se encontraron resultados.</div>`;
  });

  // Inicializaci√≥n
  document.addEventListener('DOMContentLoaded', ()=>{
    setupMapListeners();
    // Preload canvas size and ensure chart container height set
    const canvas = document.getElementById('graficoEstadisticas');
    canvas.width = canvas.clientWidth;
    // initial placeholder: nothing until user opens dept
  });

  // Accessibility: ESC to close overlay
  document.addEventListener('keydown', (e)=>{
    if(e.key === 'Escape' && document.getElementById('seccion-departamento').style.display === 'flex'){
      closeDept();
    }
  });
</script>
<script>
// ------------ MOSTRAR / OCULTAR LA SECCI√ìN DE LA GR√ÅFICA ------------
document.getElementById("openGrafBtn").addEventListener("click", () => {
  const seccion = document.getElementById("graficaMatematica");
  seccion.classList.toggle("hidden");
  seccion.scrollIntoView({ behavior: "smooth" });
});

// ------------ GR√ÅFICA LINEAL ------------
let graficoLineal = null;

const datosLinea = {
  genero: [40, 60],
  edad: [15, 30, 22, 18],
  zona: [30, 50, 20]
};

const textosExplicacion = {
  genero: "La pendiente representa el cambio entre hombres y mujeres.",
  edad: "La pendiente muestra c√≥mo var√≠a la cantidad de j√≥venes por rango de edad.",
  zona: "La pendiente indica la distribuci√≥n entre zonas rural, urbana y metropolitana."
};

function renderGrafica(tipo) {
  const ctx = document.getElementById("lineChart").getContext("2d");

  if (graficoLineal) graficoLineal.destroy();

  graficoLineal = new Chart(ctx, {
    type: "line",
    data: {
      labels: tipo === "genero" ? ["Hombres", "Mujeres"] :
              tipo === "edad" ? ["14-17", "18-21", "22-25", "+25"] :
              ["Rural", "Urbana", "Metro"],
      datasets: [{
        label: "Valores",
        data: datosLinea[tipo],
        borderWidth: 3,
        tension: 0.3
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false
    }
  });

  document.getElementById("explicacionTexto").textContent = textosExplicacion[tipo];
}

// ------------ EVENTOS DE BOTONES DE FILTRO ------------
document.querySelectorAll(".filtroBtn").forEach(btn => {
  btn.addEventListener("click", () => {
    const tipo = btn.dataset.filtro;
    renderGrafica(tipo);
  });
});
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
// Abrir modal
document.getElementById("btnGrafica").addEventListener("click", () => {
  document.getElementById("modalGrafica").style.display = "flex";
});

// Cerrar modal
document.getElementById("cerrarGrafica").addEventListener("click", () => {
  document.getElementById("modalGrafica").style.display = "none";
});

// Datos reales convertidos
const datos = {
  genero: [60, 62.62, 57.14, 54.17],
  edad: [15.5, 18, 17.5, 18],
  zona: [4, 4, 16, 4]
};

const sedes = ["San Salvador","Santa Ana","Sonsonate","San Miguel"];

const explicacion = {
  genero:
    "Representa el porcentaje de ni√±as por sede. Matem√°ticamente, la pendiente m = (y‚ÇÇ ‚àí y‚ÇÅ) / (x‚ÇÇ ‚àí x‚ÇÅ) indica la tasa de cambio del porcentaje entre sedes; si m > 0 aumenta la participaci√≥n femenina, si m < 0 disminuye.",
  
  edad:
    "Muestra la edad promedio por sede. La pendiente m = (y‚ÇÇ ‚àí y‚ÇÅ) / (x‚ÇÇ ‚àí x‚ÇÅ) refleja c√≥mo var√≠a la edad al comparar sedes; valores positivos indican grupos m√°s mayores y valores negativos indican grupos m√°s j√≥venes.",
  
  zona:
    "Indica cu√°ntos departamentos atiende cada sede. La pendiente m = (y‚ÇÇ ‚àí y‚ÇÅ) / (x‚ÇÇ ‚àí x‚ÇÅ) muestra la variaci√≥n en cobertura territorial; m > 0 significa expansi√≥n y m < 0 reducci√≥n."
};

let grafico = null;

// funci√≥n que dibuja la gr√°fica
function render(filtro) {
  const ctx = document.getElementById("lineChart").getContext("2d");
  if (grafico) grafico.destroy();

  grafico = new Chart(ctx, {
    type: "line",
    data: {
      labels: sedes,
      datasets: [{
        label: filtro,
        data: datos[filtro],
        borderWidth: 3,
        tension: 0.3
      }]
    },
    options: { responsive: true, maintainAspectRatio: false }
  });

  document.getElementById("explicacionTexto").textContent = explicacion[filtro];
}

// Eventos de botones
document.querySelectorAll(".filtroBtn").forEach(btn => {
  btn.addEventListener("click", () => {
    render(btn.dataset.filtro);
  });
});
</script>
</body>
</html>