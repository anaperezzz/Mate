<!doctype html>
<html lang="es" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ruta Lineal: Trayecto a Oportunidades</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&amp;family=Inter:wght@400;500;600&amp;display=swap" rel="stylesheet">
  <style>
        body {
            box-sizing: border-box;
        }
        
        .montserrat { font-family: 'Montserrat', sans-serif; }
        .inter { font-family: 'Inter', sans-serif; }
        
        .bg-midnight { background-color: #0F4C81; }
        .bg-turquoise { background-color: #29A3B1; }
        .bg-orange { background-color: #FF8A00; }
        .text-midnight { color: #0F4C81; }
        .text-turquoise { color: #29A3B1; }
        .text-orange { color: #FF8A00; }
        .border-midnight { border-color: #0F4C81; }
        .border-turquoise { border-color: #29A3B1; }
        
        .map-texture {
            background-image: 
                radial-gradient(circle at 25% 25%, #f0f9ff 2px, transparent 2px),
                radial-gradient(circle at 75% 75%, #e0f2fe 1px, transparent 1px);
            background-size: 50px 50px;
            background-color: #fafbfc;
        }
        
        .game-panel {
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            border: 2px solid #e2e8f0;
            box-shadow: 0 8px 32px rgba(15, 76, 129, 0.1);
            transition: all 0.3s ease;
        }
        
        .game-panel:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(15, 76, 129, 0.15);
        }
        
        .pixel-icon {
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
        
        .bus-animation {
            transition: all 2s ease-in-out;
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Keyframes para una animaci√≥n m√°s precisa en la nueva gr√°fica */
        @keyframes busMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(var(--bus-final-x), var(--bus-final-y)); }
        }
        
        .bus-moving {
            animation: busMove var(--bus-duration) linear forwards; /* 'forwards' para que se quede al final */
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #29A3B1 0%, #FF8A00 100%);
        }
        
        .game-button {
            background: linear-gradient(145deg, #29A3B1 0%, #0F4C81 100%);
            transition: all 0.3s ease;
            transform: translateY(0);
        }
        
        .game-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(41, 163, 177, 0.3);
        }
        
        .game-button:active {
            transform: translateY(0);
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full map-texture inter">
  <div class="min-h-full p-4">
   <div class="max-w-7xl mx-auto">
    <header class="text-center mb-8 fade-in">
     <div class="flex items-center justify-center gap-4 mb-4">
      <div class="w-16 h-16 bg-orange rounded-lg flex items-center justify-center pixel-icon">
       üèÅ
      </div>
      <div>
       <h1 id="main-title" class="text-4xl md:text-5xl font-bold text-midnight montserrat">Ruta Lineal: Trayecto de Casa a Oportunidades</h1>
       <p id="subtitle" class="text-lg text-turquoise font-medium mt-2">Modelo matem√°tico del recorrido usando una funci√≥n lineal</p>
      </div>
      <div class="w-16 h-16 bg-turquoise rounded-lg flex items-center justify-center pixel-icon">
       üöå
      </div>
     </div>
    </header>
    <div class="grid lg:grid-cols-3 gap-6 mb-8">
     <div class="game-panel rounded-2xl p-6 fade-in">
      <div class="flex items-center gap-3 mb-4">
       <div class="w-10 h-10 bg-midnight rounded-lg flex items-center justify-center text-white text-xl">
        üìç
       </div>
       <h2 class="text-xl font-bold text-midnight montserrat">Planteamiento del Problema</h2>
      </div>
      <p id="problem-text" class="text-gray-700 mb-4 leading-relaxed">Modelamos el trayecto de mi casa a Oportunidades. Seg√∫n Google Maps, la distancia es de 41 km y el tiempo total estimado es de 77 minutos. Queremos representar este recorrido como una funci√≥n lineal, donde el tiempo depende directamente de la distancia recorrida. As√≠ podremos interpretar la velocidad promedio y el comportamiento del viaje de forma matem√°tica.</p>
      <div class="mb-4 text-center">
       <img src="mapa.jpg" alt="Mapa del recorrido de casa a Oportunidades" class="max-w-full h-auto rounded-lg shadow-md mx-auto" style="max-height: 200px; width: auto;">
       <p class="text-gray-600 text-sm mt-2">Trayecto de 41 km y 77 min, seg√∫n Google Maps.</p>
      </div>
      <button class="game-button text-white px-4 py-2 rounded-lg font-medium text-sm"> üì± Datos en Google Maps </button>
     </div>
     <div class="game-panel rounded-2xl p-6 fade-in">
      <div class="flex items-center gap-3 mb-4">
       <div class="w-10 h-10 bg-turquoise rounded-lg flex items-center justify-center text-white text-xl">
        üìä
       </div>
       <h2 class="text-xl font-bold text-midnight montserrat">Datos y Ecuaci√≥n</h2>
      </div>
      <div class="mb-6">
       <table class="w-full border-collapse">
        <thead>
         <tr class="bg-gray-100">
          <th class="border border-gray-300 px-3 py-2 text-midnight font-semibold">Distancia (km)</th>
          <th class="border border-gray-300 px-3 py-2 text-midnight font-semibold">Tiempo (min)</th>
         </tr>
        </thead>
        <tbody>
         <tr>
          <td class="border border-gray-300 px-3 py-2 text-center">0</td>
          <td class="border border-gray-300 px-3 py-2 text-center">0</td>
         </tr>
         <tr>
          <td class="border border-gray-300 px-3 py-2 text-center">10</td>
          <td class="border border-gray-300 px-3 py-2 text-center">18.8</td>
         </tr>
         <tr>
          <td class="border border-gray-300 px-3 py-2 text-center">20</td>
          <td class="border border-gray-300 px-3 py-2 text-center">37.6</td>
         </tr>
         <tr>
          <td class="border border-gray-300 px-3 py-2 text-center">30</td>
          <td class="border border-gray-300 px-3 py-2 text-center">56.4</td>
         </tr>
         <tr>
          <td class="border border-gray-300 px-3 py-2 text-center">41</td>
          <td class="border border-gray-300 px-3 py-2 text-center">77</td>
         </tr>
        </tbody>
       </table>
      </div>
      <div class="bg-gradient-to-r from-turquoise to-midnight text-white p-4 rounded-lg">
       <div class="text-center">
        <div id="equation-text" class="text-2xl font-bold montserrat mb-2">
         y = 1.878x
        </div>
        <div class="text-sm">
         <p><strong>m = 1.878 min/km</strong> ‚Üí El bus tarda 1.878 minutos en recorrer cada kil√≥metro.</p>
         <p><strong>b = 0</strong> ‚Üí El recorrido empieza sin tiempo de espera inicial.</p>
        </div>
       </div>
      </div>
     </div>
     <div class="game-panel rounded-2xl p-6 fade-in">
      <div class="flex items-center gap-3 mb-4">
       <div class="w-10 h-10 bg-orange rounded-lg flex items-center justify-center text-white text-xl">
        üìà
       </div>
       <h2 class="text-xl font-bold text-midnight montserrat">Gr√°fica y Simulaci√≥n</h2>
      </div>
      <div class="relative bg-white border-2 border-gray-200 rounded-lg p-4 mb-4" style="height: 400px;">
       <svg id="mainGraph" width="100%" height="100%" class="absolute inset-0" viewbox="0 0 400 360">
        <defs>
         <pattern id="grid" width="30" height="30" patternunits="userSpaceOnUse">
          <path d="M 30 0 L 0 0 0 30" fill="none" stroke="#e5e7eb" stroke-width="1" />
         </pattern>
        </defs>
        <rect width="100%" height="100%" fill="url(#grid)" />

        <line x1="50" y1="320" x2="350" y2="320" stroke="#374151" stroke-width="3" />
        <line x1="50" y1="320" x2="50" y2="20" stroke="#374151" stroke-width="3" />

        <line x1="50" y1="20" x2="50" y2="320" stroke="#d1d5db" stroke-width="1" />
        <line x1="116.6" y1="20" x2="116.6" y2="320" stroke="#d1d5db" stroke-width="1" />
        <line x1="183.2" y1="20" x2="183.2" y2="320" stroke="#d1d5db" stroke-width="1" />
        <line x1="249.8" y1="20" x2="249.8" y2="320" stroke="#d1d5db" stroke-width="1" />
        <line x1="316.4" y1="20" x2="316.4" y2="320" stroke="#d1d5db" stroke-width="1" />

        <line x1="50" y1="320" x2="350" y2="320" stroke="#d1d5db" stroke-width="1" />
        <line x1="50" y1="245" x2="350" y2="245" stroke="#d1d5db" stroke-width="1" />
        <line x1="50" y1="170" x2="350" y2="170" stroke="#d1d5db" stroke-width="1" />
        <line x1="50" y1="95" x2="350" y2="95" stroke="#d1d5db" stroke-width="1" />

        <text x="50" y="335" text-anchor="middle" class="text-xs fill-gray-700 font-semibold">0</text>
        <text x="116.6" y="335" text-anchor="middle" class="text-xs fill-gray-700 font-semibold">10</text>
        <text x="183.2" y="335" text-anchor="middle" class="text-xs fill-gray-700 font-semibold">20</text>
        <text x="249.8" y="335" text-anchor="middle" class="text-xs fill-gray-700 font-semibold">30</text>
        <text x="316.4" y="335" text-anchor="middle" class="text-xs fill-gray-700 font-semibold">40</text>

        <text x="40" y="325" text-anchor="end" class="text-xs fill-gray-700 font-semibold">0</text>
        <text x="40" y="245" text-anchor="end" class="text-xs fill-gray-700 font-semibold">20</text>
        <text x="40" y="170" text-anchor="end" class="text-xs fill-gray-700 font-semibold">40</text>
        <text x="40" y="95" text-anchor="end" class="text-xs fill-gray-700 font-semibold">60</text>
        <text x="40" y="20" text-anchor="end" class="text-xs fill-gray-700 font-semibold">80</text>

        <line id="street-base" x1="50" y1="320" x2="323.06" y2="31.25" stroke="#6B7280" stroke-width="12" stroke-linecap="round" />
        <line id="street-surface" x1="50" y1="320" x2="323.06" y2="31.25" stroke="#FCD34D" stroke-width="8" stroke-linecap="round" />
        <line id="street-center" x1="50" y1="320" x2="323.06" y2="31.25" stroke="#FFFFFF" stroke-width="1" stroke-dasharray="4,3" stroke-linecap="round" />
        <line id="function-line" x1="50" y1="320" x2="323.06" y2="31.25" stroke="#29A3B1" stroke-width="2" opacity="0.7" stroke-dasharray="2,2" />

        <circle cx="50" cy="320" r="4" fill="#0F4C81" /> <circle cx="50 + (10 * 6.66)" cy="320 - (18.8 * 3.75)" r="4" fill="#0F4C81" /> <circle cx="50 + (20 * 6.66)" cy="320 - (37.6 * 3.75)" r="4" fill="#0F4C81" /> <circle cx="50 + (30 * 6.66)" cy="320 - (56.4 * 3.75)" r="4" fill="#0F4C81" /> <circle cx="50 + (41 * 6.66)" cy="320 - (77 * 3.75)" r="4" fill="#0F4C81" /> <text x="200" y="350" text-anchor="middle" class="text-sm fill-gray-600 font-semibold">Distancia (km)</text>
        <text x="25" y="170" text-anchor="middle" class="text-sm fill-gray-600 font-semibold" transform="rotate(-90 25 170)">Tiempo (min)</text>
       </svg>
       <div id="animated-bus" class="absolute text-2xl" style="left: 42px; top: 312px; z-index: 10;">
        üöå
       </div>
       <div id="speed-counter" class="absolute top-4 right-4 bg-midnight text-white px-3 py-1 rounded-lg text-sm font-bold">
        Velocidad: 1.878 min/km
       </div>
       <div id="position-counter" class="absolute top-4 left-4 bg-orange text-white px-3 py-1 rounded-lg text-sm font-bold">
        Posici√≥n: (0, 0)
       </div>
      </div>
      <div class="flex gap-3 justify-center">
       <button id="play-btn" class="game-button text-white px-6 py-2 rounded-lg font-medium"> ‚ñ∂Ô∏è Reproducir </button>
       <button id="pause-btn" class="game-button text-white px-6 py-2 rounded-lg font-medium"> ‚è∏Ô∏è Pausar </button>
       <button id="reset-btn" class="game-button text-white px-6 py-2 rounded-lg font-medium"> üîÑ Reiniciar </button>
      </div>
     </div>
    </div>
    <div class="game-panel rounded-2xl p-6 mb-8 fade-in">
     <div class="flex items-center gap-3 mb-6">
      <div class="w-12 h-12 bg-turquoise rounded-lg flex items-center justify-center text-white text-2xl">
       üîß
      </div>
      <h2 class="text-2xl font-bold text-midnight montserrat">Procedimiento y Soluci√≥n</h2>
     </div>
     <div class="grid md:grid-cols-2 gap-8">
      <div>
       <h3 class="text-lg font-semibold text-midnight mb-4 montserrat">Pasos del Proceso:</h3>
       <ol class="space-y-3 text-gray-700">
        <li class="flex items-start gap-3"><span class="bg-midnight text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold">1</span> Consultar la distancia y tiempo en Google Maps.</li>
        <li class="flex items-start gap-3"><span class="bg-midnight text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold">2</span> Registrar los pares ordenados (x = km, y = minutos).</li>
        <li class="flex items-start gap-3"><span class="bg-midnight text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold">3</span> Calcular la pendiente con la f√≥rmula m=(y‚ÇÇ-y‚ÇÅ)/(x‚ÇÇ-x‚ÇÅ)</li>
        <li class="flex items-start gap-3"><span class="bg-midnight text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold">4</span> Determinar el intercepto b (cuando x = 0).</li>
        <li class="flex items-start gap-3"><span class="bg-midnight text-white w-6 h-6 rounded-full flex items-center justify-center text-sm font-bold">5</span> Escribir la ecuaci√≥n lineal y=mx+b y representarla gr√°ficamente.</li>
       </ol>
      </div>
      <div>
       <h3 class="text-lg font-semibold text-midnight mb-4 montserrat">Ejemplo de C√°lculo:</h3>
       <div class="bg-gray-50 p-4 rounded-lg">
        <p class="mb-2"><strong>C√°lculo de la pendiente:</strong></p>
        <p class="text-turquoise font-mono">m = 77/41 = 1.878</p>
        <p class="mt-4 mb-2"><strong>Intercepto:</strong></p>
        <p class="text-turquoise font-mono">b = 0</p>
        <p class="mt-4 mb-2"><strong>Ecuaci√≥n final:</strong></p>
        <p class="text-orange font-mono text-lg font-bold">y = 1.878x</p>
        <div class="mt-4 p-3 bg-midnight text-white rounded-lg">
         <p class="text-sm"><strong>Conclusi√≥n:</strong> La pendiente representa los minutos que tarda el bus en recorrer cada kil√≥metro. La relaci√≥n entre distancia y tiempo es directamente proporcional, lo que muestra un movimiento uniforme durante todo el recorrido.</p>
        </div>
       </div>
      </div>
     </div>
    </div>
    <footer class="game-panel rounded-2xl p-6 text-center fade-in">
     <div class="flex items-center justify-center gap-4 mb-4"><span class="text-2xl">üéØ</span> <span class="text-2xl">üìä</span> <span class="text-2xl">üöå</span> <span class="text-2xl">üìà</span>
     </div>
     <p id="footer-text" class="text-gray-700 text-lg"><strong>Conclusi√≥n:</strong> La pendiente (1.878 min/km) representa los minutos que tarda el bus en recorrer cada kil√≥metro. El intercepto (0) indica que el recorrido comienza sin tiempo de espera inicial, estableciendo una relaci√≥n directamente proporcional y un movimiento uniforme.  </p>
    </footer>
   </div>
  </div>
  <script>
        // Default configuration - Actualizado
        const defaultConfig = {
            main_title: "Ruta Lineal: Trayecto de Casa a Oportunidades",
            subtitle: "Modelo matem√°tico del recorrido usando una funci√≥n lineal",
            problem_text: "Modelamos el trayecto de mi casa a Oportunidades. Seg√∫n Google Maps, la distancia es de 41 km y el tiempo total estimado es de 77 minutos. Queremos representar este recorrido como una funci√≥n lineal, donde el tiempo depende directamente de la distancia recorrida. As√≠ podremos interpretar la velocidad promedio y el comportamiento del viaje de forma matem√°tica.",
            equation_text: "y = 1.878x",
            footer_text: "<strong>Conclusi√≥n:</strong> La pendiente (1.878 min/km) representa los minutos que tarda el bus en recorrer cada kil√≥metro. El intercepto (0) indica que el recorrido comienza sin tiempo de espera inicial, estableciendo una relaci√≥n directamente proporcional y un movimiento uniforme."
        };

        // Escala SVG:
        // Ancho del √°rea de gr√°fica: 300px (de 50 a 350 en viewbox)
        // Altura del √°rea de gr√°fica: 300px (de 20 a 320 en viewbox)
        // Max X (km) = 41
        // Max Y (min) = 77
        // Factor de escala X: (300px / 41km) = 7.317 px/km
        // Factor de escala Y: (300px / 77min) = 3.896 px/min
        const SVG_ORIGIN_X = 50;
        const SVG_ORIGIN_Y = 320; // Bottom-left origin for cartesian plane
        const SCALE_X = 7.317; // px per km
        const SCALE_Y = 3.896; // px per min

        // Animation variables
        let animationRunning = false;
        let animationInterval;
        let currentStep = 0;
        
        // Data points (x=km, y=min)
        const rawDataPoints = [
            {x: 0, y: 0},
            {x: 10, y: 18.8},
            {x: 20, y: 37.6},
            {x: 30, y: 56.4},
            {x: 41, y: 77}
        ];

        // Transform raw data points to SVG coordinates and positions for the bus
        const dataPoints = rawDataPoints.map(point => ({
            x: point.x,
            y: point.y,
            // Calculate SVG coordinates
            svg_x: SVG_ORIGIN_X + (point.x * SCALE_X),
            svg_y: SVG_ORIGIN_Y - (point.y * SCALE_Y),
            // Calculate pixel position for the bus (adjust slightly for bus icon center)
            pos: {
                left: SVG_ORIGIN_X + (point.x * SCALE_X) - 8, // Adjust for üöå icon width
                top: SVG_ORIGIN_Y - (point.y * SCALE_Y) - 8  // Adjust for üöå icon height
            }
        }));

        // DOM elements
        const animatedBus = document.getElementById('animated-bus');
        const positionCounter = document.getElementById('position-counter');
        const speedCounter = document.getElementById('speed-counter');
        const playBtn = document.getElementById('play-btn');
        const pauseBtn = document.getElementById('pause-btn');
        const resetBtn = document.getElementById('reset-btn');

        // Animation functions
        function startAnimation() {
            if (animationRunning) return;
            
            animationRunning = true;
            playBtn.textContent = '‚è∏Ô∏è Pausar';
            
            animationInterval = setInterval(() => {
                if (currentStep < dataPoints.length - 1) {
                    currentStep++;
                    const point = dataPoints[currentStep];
                    
                    // Move bus using CSS transform (more performant)
                    animatedBus.style.transition = 'transform 2s ease-in-out';
                    animatedBus.style.transform = `translate(${point.pos.left - dataPoints[0].pos.left}px, ${point.pos.top - dataPoints[0].pos.top}px)`;
                    
                    // Update position counter
                    positionCounter.textContent = `Posici√≥n: (${point.x}, ${point.y})`;
                    
                    // Add bounce effect
                    animatedBus.style.transform += ' scale(1.2)';
                    setTimeout(() => {
                        animatedBus.style.transform = animatedBus.style.transform.replace(' scale(1.2)', ' scale(1)');
                    }, 200);
                } else {
                    // Animation complete
                    pauseAnimation();
                    setTimeout(resetAnimation, 1000);
                }
            }, 2000); // Time between data points
        }

        function pauseAnimation() {
            animationRunning = false;
            clearInterval(animationInterval);
            playBtn.textContent = '‚ñ∂Ô∏è Reproducir';
            // Stop any ongoing transform
            animatedBus.style.transition = 'none';
        }

        function resetAnimation() {
            pauseAnimation();
            currentStep = 0;
            const point = dataPoints[0];
            animatedBus.style.transition = 'none'; // Remove transition for instant reset
            animatedBus.style.transform = 'translate(0, 0)'; // Reset transform
            animatedBus.style.left = point.pos.left + 'px';
            animatedBus.style.top = point.pos.top + 'px';
            positionCounter.textContent = `Posici√≥n: (${point.x}, ${point.y})`;
            speedCounter.textContent = `Velocidad: 1.878 min/km`; // Ensure speed is reset correctly
        }

        // Event listeners
        playBtn.addEventListener('click', () => {
            if (animationRunning) {
                pauseAnimation();
            } else {
                startAnimation();
            }
        });

        pauseBtn.addEventListener('click', pauseAnimation);
        resetBtn.addEventListener('click', resetAnimation);

        // Element SDK implementation
        async function onConfigChange(config) {
            document.getElementById('main-title').textContent = config.main_title || defaultConfig.main_title;
            document.getElementById('subtitle').textContent = config.subtitle || defaultConfig.subtitle;
            document.getElementById('problem-text').textContent = config.problem_text || defaultConfig.problem_text;
            document.getElementById('equation-text').textContent = config.equation_text || defaultConfig.equation_text;
            document.getElementById('footer-text').textContent = config.footer_text || defaultConfig.footer_text;
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            };
        }

        function mapToEditPanelValues(config) {
            return new Map([
                ["main_title", config.main_title || defaultConfig.main_title],
                ["subtitle", config.subtitle || defaultConfig.subtitle],
                ["problem_text", config.problem_text || defaultConfig.problem_text],
                ["equation_text", config.equation_text || defaultConfig.equation_text],
                ["footer_text", config.footer_text || defaultConfig.footer_text]
            ]);
        }

        // Initialize Element SDK
        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange,
                mapToCapabilities,
                mapToEditPanelValues
            });
        }

        // Initialize animation
        resetAnimation();
    </script>
 </body>
</html>